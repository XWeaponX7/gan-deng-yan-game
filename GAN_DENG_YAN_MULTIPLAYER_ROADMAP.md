# 干瞪眼多人模式 (2-6人) 升级路线图与设计文档

本文档详细规划了将"干瞪眼"游戏从2人对战模式升级为支持最多6人对战模式的完整设计方案，涵盖UI布局、产品体验优化、技术实现优先级等。

## 核心设计原则

1.  **向后兼容**: 2人模式的核心体验与现有版本几乎保持一致。
2.  **渐进式适配**: 随着玩家人数增加，UI和交互能优雅地扩展。
3.  **移动优先**: 所有设计首先确保在手机等小屏幕设备上获得良好体验。
4.  **认知简单**: 尽可能模拟现实世界中线下打牌的场景和信息流，降低用户学习成本。

---

## UI布局设计方案

采用**固定区域布局**，在不同人数下保持信息架构的稳定性。

### 2人模式 (保持现状)

基本保持当前成熟的上下布局，确保老用户无感知升级。

```
┌─────────────────────────────┐
│        对手信息区域            │ 
│    小明 (5张) [上次出牌]       │
├─────────────────────────────┤
│         游戏状态区             │
│     当前轮次：你的回合          │
├─────────────────────────────┤
│        我的手牌区域            │
│   [3♠][7♥][J♣][Q♦][K♠]      │
└─────────────────────────────┘
```

### 3-4人模式 (上方扩展布局)

其他玩家信息横向排列在屏幕上方，当前出牌者会有高亮或放大效果以作区分。

```
┌─────────────────────────────┐
│  👤小明(5)  🎯小王(3)  👤小李(2) │ <- 其他玩家（当前出牌者突出显示）
├─────────────────────────────┤
│      桌面区域：[K♠][K♥]        │ <- 当前桌面牌型
│       (小王刚出的对子K)         │
├─────────────────────────────┤
│   🎮 轮到你了 | ⏸️ 过牌 | ❓    │ <- 操作区
├─────────────────────────────┤
│        我的手牌区域            │
│   [3♠][7♥][J♣][Q♦][K♠]      │
└─────────────────────────────┘
```

### 5-6人模式 (紧凑网格布局)

当玩家数超过4人时，上方玩家信息区会自动扩展为两行，以在有限空间内容纳所有玩家。

```
┌─────────────────────────────┐
│ 👤小明(5) 🎯小王(3) 👤小李(2)   │ 
│ 👤小陈(4) 👤小张(1) 👤小赵(6)   │ <- 两行显示
├─────────────────────────────┤
│    桌面：[K♠][K♥] (小王出的)    │
├─────────────────────────────┤
│        我的手牌(7张)           │
│   [3♠][7♥][J♣][Q♦][K♠]...    │
└─────────────────────────────┘
```

---

## 核心UI元素详细设计

-   **玩家状态**:
    -   `🎯 小王(3张)`: 当前出牌者，用图标和高亮边框突出。
    -   `👤 小明(5张)`: 普通等待状态。
    -   `💤 小李(过牌)`: 显示刚执行"过牌"操作的玩家，状态持续到下一轮。
    -   `🏆 小陈(胜利)`: 已出完所有牌的玩家。

-   **桌面区域**:
    -   清晰展示最后一次出的牌、出牌者和牌型。
    -   提供智能提示，告知当前玩家可以出哪些牌来接。
    -   示例: `📏 你可以出: 对子A, 对子2, 任意炸弹`

-   **游戏状态栏**:
    -   `🎮 轮到: 小明 | 🎯 等待: 2人 | 🃏 牌堆: 23张 | ⏱️ 01:23`

---

## 产品体验与流程优化

### 1. 房间创建/加入流程

-   **模式选择**: 用户在开始匹配前，可以自由选择希望参与的游戏人数（2-6人），2人模式设为"快速匹配"。
-   **等待房间**:
    -   清晰展示目标人数和当前已加入人数（如 `3/4`）。
    -   房主可以邀请朋友或在人满后开始游戏。
    -   显示已加入玩家列表。

### 2. 智能匹配策略

-   **优先级算法**: 优先满足小房间（2-3人）的匹配以减少等待时间。对于大房间（5-6人），设置一个匹配超时（如60秒），超时后向用户建议是否切换到人数较少的房间。
-   **动态提示**: 匹配过程中提示用户等待时长，并适时提供切换模式的选项。

### 3. 游戏内体验优化

-   **轮次提醒**:
    -   顶部横幅提示："轮到小明了！"
    -   手机震动或短音效提示自己的回合开始。
    -   提前一轮进行预告："马上轮到你了！"
-   **进度提示**: 显示当前游戏轮数、总时长以及出牌顺序（`你 → 小明 → 小王 → 你`）。
-   **智能操作提示**: 根据桌面牌型，动态提示当前玩家所有合法的出牌选择。

### 4. 中途退出与断线重连

-   **等待阶段退出**: 系统自动寻找新玩家填补空位，或提示房主是否以当前人数开始。
-   **游戏中掉线**: 为掉线玩家保留60秒重连时间，期间游戏暂停或由AI托管。超时后该玩家被移除，游戏继续。

### 5. 社交功能增强

-   **快速表情**: 提供"点赞"、"庆祝"、"惊讶"等快捷表情，增加玩家互动。
-   **局后总结**: 清晰展示本局排名、每个玩家的剩余牌数和游戏时长，并提供"再来一局"和"更换人数"的选项。

---

## 技术实现优先级

1.  **Phase 1: 核心多人支持 (预计1周)**
    -   后端逻辑支持3-4人游戏。
    -   实现3-4人模式的UI布局。
    -   实现基础的房间创建和等待系统。

2.  **Phase 2: 体验优化 (预计1周)**
    -   实现智能匹配算法和动态提示。
    -   完善断线重连机制。
    -   开发智能操作提示系统。

3.  **Phase 3: 社交与高级功能 (预计1周)**
    -   添加5-6人模式支持。
    -   实现快捷表情和局后总结面板。
    -   开发邀请朋友功能。 